<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Grunt-contrib-imagemin : erreur de compilation sur OSX Mavericks (pngquant)</title>
    <meta name="description" content="Si vous utilisez Grunt et plus précisément le module grunt-contrib-imagemin afin de compresser vos images à la volée, vous vous êtes peut être rendu compte q...">

    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="canonical" href="http://elliptips.info/grunt-contrib-imagemin-erreur-de-compilation-sur-osx-mavericks-pngquant/">
    <link rel="alternate" type="application/rss+xml" title="Elliptips" href="/feed.xml">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600" rel="stylesheet">
    <link href="https://file.myfontastic.com/A2MgA9Cd47cENMsNJcc2Gk/icons.css" rel="stylesheet">
    
    
</head>


  <body>

    <header class="header" role="banner">
    <div class="container">
        <a class="logo" href="/">Elliptips</a>

        <nav class="nav">
            <a href="">A propos</a>
            <a href="https://twitter.com/robin_parisi" target="_blank">Twitter</a>
            <a href="https://github.com/robinparisi" target="_blank">Github</a>
        </nav>
    </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

    <header class="post-header">
        <div class="post-header__wrapper container">
            <h1 class="post-title" itemprop="name headline">Grunt-contrib-imagemin : erreur de compilation sur OSX Mavericks (pngquant)</h1>
            <div class="post-context">
                <div><i class="post-metaIcon icon-calendar"></i><span class="post-metaItem"><time datetime="2014-07-28T16:58:54+02:00" itemprop="datePublished">publié le 28/07/2014</time></span></div>
                <div><i class="post-metaIcon icon-clock"></i><span class="post-metaItem">Temps de lecture : 

1 min

</span></div>
                <div><i class="post-metaIcon icon-pencil"></i><span class="post-metaItem"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Robin</span></span></span></div>
                <div class="post-shareBox">
                    Partager :
                    <a href="#" title="Partager sur Twitter"><i class="icon-twitter color-twitter"></i></a>
                    <a href="#" title="Partager sur Facebook"><i class="icon-facebook color-facebook"></i></a>
                    <a href="#" title="Partager sur Google+"><i class="icon-google-plus color-google"></i></a>
                    <a href="#" title="Partager par e-mail+"><i class="icon-envelope color-mail"></i></a>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="post-content" itemprop="articleBody">
            <p>Si vous utilisez <a href="http://gruntjs.com/">Grunt</a> et plus précisément le module <a href="https://github.com/gruntjs/grunt-contrib-imagemin">grunt-contrib-imagemin</a> afin de compresser vos images à la volée, vous vous êtes peut être rendu compte que l’installation pose problème sur Mavericks (la dernière version d’OSX).</p>

<p>En effet, le module utilise plusieurs libs de compression dont l’excellent <a href="http://pngquant.org/"><strong>pngquant</strong></a> qui n’est malheureusement plus distribué avec le système.</p>

<p>Aussi, l’installation via npm vous gratifiera du magnifique message d’erreur suivant :</p>

<pre class="lang:sh decode:true">&gt; pngquant-bin@0.3.1 postinstall /****/node_modules/grunt-contrib-imagemin/node_modules/imagemin/node_modules/imagemin-pngquant/node_modules/pngquant-bin
&gt; node index.js

✗ pre-build test failed, compiling from source...
libpng-dev is installed

{ [Error: Command failed: In file included from pngquant.c:59:
./rwpng.h:35:10: fatal error: 'png.h' file not found
#include "png.h"    /* libpng header; includes zlib.h */
         ^
1 error generated.
make: *** [pngquant.o] Error 1
] killed: false, code: 2, signal: null }</pre>

<p>Pour corriger cela, rien de plus simple, commencez par supprimez le dossier node_modules de votre projet :</p>

<pre class="lang:sh decode:true">rm -rf node_modules</pre>

<p>Installez ensuite pngquant sur votre système (si vous n’avez pas brew, commencer par l’installer) :</p>

<pre class="lang:default decode:true">brew install libpng</pre>

<p>Puis on relance l’installation des modules :</p>

<pre class="lang:sh decode:true">npm install</pre>

<p>Résultat :</p>

<pre class="lang:sh decode:true">✓ pre-build test passed successfully
 
&gt; pngquant-bin@0.3.1 postinstall /****/node_modules/grunt-contrib-imagemin/node_modules/imagemin/node_modules/imagemin-pngquant/node_modules/pngquant-bin
&gt; node index.js</pre>

        </div>
    </div>

    
</article>

      </div>
    </main>

    <div class="container">
    <footer class="footer txtcenter">
        Sauf mention spéciale, le contenu de ce site est distribué sous licence <a href="#">CC BY-NC-SA 3.0</a>
    </footer>
</div>


  </body>

</html>
