<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Installer Apache, MySQL et PHP sous OSX sans passer par MAMP</title>
    <meta name="description" content="Venant tout juste de changer de Mac, je dÃ©couvre Mountain Lion et je me suis dit quâ€™il Ã©tait temps de mettre un peu dâ€™ordre dans mon environnement de dÃ©velop...">

    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="canonical" href="http://elliptips.info/installer-apache-mysql-et-php-sous-osx-sans-passer-par-mamp/">
    <link rel="alternate" type="application/rss+xml" title="Elliptips" href="/feed.xml">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600" rel="stylesheet">
    <link href="https://file.myfontastic.com/A2MgA9Cd47cENMsNJcc2Gk/icons.css" rel="stylesheet">
    
    
</head>


  <body>

    <header class="header" role="banner">
    <div class="container">
        <a class="logo" href="/">Elliptips</a>

        <nav class="nav">
            <a href="">A propos</a>
            <a href="https://twitter.com/robin_parisi" target="_blank">Twitter</a>
            <a href="https://github.com/robinparisi" target="_blank">Github</a>
        </nav>
    </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

    <header class="post-header">
        <div class="post-header__wrapper container">
            <h1 class="post-title" itemprop="name headline">Installer Apache, MySQL et PHP sous OSX sans passer par MAMP</h1>
            <div class="post-context">
                <div><i class="post-metaIcon icon-calendar"></i><span class="post-metaItem"><time datetime="2012-11-16T09:30:55+01:00" itemprop="datePublished">publiÃ© le 16/11/2012</time></span></div>
                <div><i class="post-metaIcon icon-clock"></i><span class="post-metaItem">Temps de lecture : 

8 mins

</span></div>
                <div><i class="post-metaIcon icon-pencil"></i><span class="post-metaItem"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Robin</span></span></span></div>
                <div class="post-shareBox">
                    Partager :
                    <a href="#" title="Partager sur Twitter"><i class="icon-twitter color-twitter"></i></a>
                    <a href="#" title="Partager sur Facebook"><i class="icon-facebook color-facebook"></i></a>
                    <a href="#" title="Partager sur Google+"><i class="icon-google-plus color-google"></i></a>
                    <a href="#" title="Partager par e-mail+"><i class="icon-envelope color-mail"></i></a>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="post-content" itemprop="articleBody">
            <p>Venant tout juste de changer de Mac, je dÃ©couvre <strong>Mountain Lion</strong> et je me suis dit quâ€™il Ã©tait temps de mettre un peu dâ€™ordre dans mon environnement de dÃ©veloppement. Jâ€™avais lâ€™habitude dâ€™utiliser <strong>MAMP</strong> pour le dÃ©veloppement web, car celui-ci a lâ€™avantage indÃ©niable de fournir un package prÃªt Ã  lâ€™emploi, le tout en un clic. Revers de la mÃ©daille, il nous rend tributaire des versions de logiciels quâ€™il propose et sâ€™intÃ¨gre parfois mal avec dâ€™autres environnements. Ainsi, nous verrons dans ce tutoriel comment mettre en place un stack AMP (<strong>Apache, MySQL et PHP</strong>) sous Mac OSX simplement et rapidement, le tout en utilisant au maximum les outils dÃ©jÃ  intÃ©grÃ©s au systÃ¨me.</p>

<p>Note : ce tutoriel a Ã©tÃ© rÃ©alisÃ© sous Mountain Lion, mais il devrait fonctionner pour les autres versions. En effet, les versions prÃ©cÃ©dentes (Snow Leopard et Lion) possÃ¨dent, elles aussi un serveur Apache intÃ©grÃ©. Si vous rencontrez des difficultÃ©s, nâ€™hÃ©sitez pas Ã  laisser un commentaire Ã  la suite de lâ€™article.</p>

<h1 id="installer-apache">Installer Apache</h1>

<p>PremiÃ¨re bonne nouvelle, Apache est dÃ©jÃ  intÃ©grÃ© Ã  votre systÃ¨me. Pour en avoir la preuve, lancez donc la commande suivanteÂ :</p>

<pre class="lang:sh decode:true">httpd -v</pre>

<p>Le retour devrait ressembler Ã  ceciÂ :</p>

<pre class="lang:default decode:true">Server version: Apache/2.2.22 (Unix)
Server built:   Aug 24 2012 17:16:58</pre>

<p>Lâ€™administration dâ€™apache se fait grÃ¢ce aux commandes suivantesÂ :</p>

<pre class="lang:sh decode:true">sudo apachectl start 
sudo apachectl restart
sudo apachectl stop
sudo apachectl graceful # relance apache en attendant la fermeture des connexions Ã©tablies</pre>

<h1 id="le-document-root">Le document root</h1>

<p>En vous rendant sur <span style="color: #000000;"><strong>http://localhost</strong></span>, vous devriez voir le cÃ©lÃ¨bre â€œIt Worksâ€.</p>

<p>Pour le moment, le document root se trouve dans :</p>

<pre class="lang:default decode:true">/Library/WebServer/Documents/</pre>

<p>Sur les anciennes versions de lâ€™OS, les utilisateurs disposaient dâ€™un dossier <strong>Sites dans leur rÃ©pertoire personnel</strong> et lâ€™on pouvait accÃ©der Ã  celui-ci via lâ€™adresse http://localhost/~user (notez lâ€™utilisation du tilde dans lâ€™adresse).</p>

<p>Nous allons utiliser ce systÃ¨me. On commence donc par crÃ©er le rÃ©pertoire Sites sâ€™il nâ€™existe pas dÃ©jÃ  (câ€™est votre cas si vous Ãªtes sous Mountain Lion).</p>

<pre class="lang:sh decode:true">mkdir ~/Sites</pre>

<p>CrÃ©ation dâ€™un fichier de configuration pour votre utilisateurÂ :</p>

<pre class="lang:sh decode:true">sudo vim /etc/apache2/users/votreuser.conf</pre>

<p>Note : si vous ne connaissez pas votre utilisateur, lancer la commande suivanteÂ :</p>

<pre class="lang:sh decode:true">whoami</pre>

<p>On y insÃ¨re la configuration suivanteÂ :</p>

<pre class="lang:default mark:8 decode:true">&lt;Directory "/Users/votreuser/Sites/"&gt;
Options Indexes MultiViews
AllowOverride All
Order allow,deny
Allow from all
&lt;/Directory&gt;

Include /Users/votreuser/Sites/httpd-vhosts.conf</pre>

<p>Le include Ã  la ligne 8 permet dâ€™apporter un peu de commoditÃ©s dans la gestion des vhosts car le fichier de conf sera disponible Ã  la racine de ~/Sites, donc accessible rapidement. Notez que vous pourriez trÃ¨s bien mettre vos vhosts Ã  la suite du fichier votreuser.conf.</p>

<p>Il faut donc crÃ©er le fichier allouÃ© Ã  la configuration des vhosts :</p>

<pre>touch ~/Sites/httpd-vhosts.conf</pre>

<p>On vÃ©rifie les permissions du fichier â€œvotreuser.confâ€ Â qui doivent Ãªtre Ã  644Â :</p>

<pre class="lang:sh decode:true">sudo chmod 644 /etc/apache2/users/robin.conf</pre>

<p>On test les changementsÂ :</p>

<pre class="lang:default decode:true">sudo apachectl restart
cd ~/Sites/
touch index.html
echo "It works from my personal folder" &gt; index.html</pre>

<p>Rendez vous surÂ <span style="color: #000000;"><strong>http://localhost/~votreuser/index.html</strong></span>. La page devrait afficher votre texte â€œIt works from my personal folderâ€.</p>

<h1 id="dition-d8217un-vhost">Ã‰dition dâ€™un vhost</h1>

<p>Les vhosts vous permettront de tester <strong>plusieurs sites en utilisant des noms de domaine en local</strong>.</p>

<p>On Ã©dite Â le fichier httpd-vhosts.confÂ :</p>

<pre class="lang:default decode:true">vim ~/Sites/httpd-vhosts.conf</pre>

<p>On y ajoute la configuration suivanteÂ :</p>

<pre class="lang:apache decode:true">NameVirtualHost *:80
&lt;Directory "/Users/votreuser/Sites"&gt;
  Options Indexes FollowSymLinks MultiViews
  AllowOverride All
  Order allow,deny
  Allow from all
&lt;/Directory&gt;

&lt;VirtualHost _default_:80&gt;
  ServerName localhost
  DocumentRoot /Library/WebServer/Documents
&lt;/VirtualHost&gt;

&lt;VirtualHost *:80&gt;
  ServerName site1.local
  DocumentRoot "/Users/votreuser/Sites/site1"
&lt;/VirtualHost&gt;</pre>

<p>La derniÃ¨re section est celle que vous devrez copier/coller pour crÃ©er autant de vhost que nÃ©cessaire.</p>

<p>Bien sÃ»r, nous ne disposons pas dâ€™un nom de domaine rÃ©el pour tester le vhost et nous nâ€™en avons dâ€™ailleurs pas besoin. Nous allons tout simplement ajouter un host dans le fichier /etc/hostsÂ :</p>

<pre class="lang:sh decode:true">sudo vim /etc/hosts</pre>

<p>On ajoute la ligne suivante (Ã  la fin du fichier)Â :</p>

<pre class="lang:default decode:true">127.0.0.1 site1.local</pre>

<p>Cette ligne aura pour effet de faire pointer le nom de domaine site1.local sur localhost.</p>

<p>Pour tester, lâ€™on crÃ©Ã© un dossier site1 dans ~/SitesÂ :</p>

<pre class="lang:default decode:true">mkdir ~/Sites/site1
touch ~/Sites/site1/index.html 
echo "It Works from site1" &gt; ~/Sites/site1/index.html</pre>

<p>On relance Apache :</p>

<pre>sudo apachectl restart</pre>

<p>On se rend sur <span style="color: #000000;"><strong>http://site1.local</strong></span> pour tester le rÃ©sultat.</p>

<h1 id="installer-php">Installer PHP</h1>

<p>Comme pour Apache, la procÃ©dure se rÃ©vÃ¨le simplissime. Il suffit de dÃ©commenter la ligne du module php5 dans le httpd.confÂ :</p>

<pre class="lang:default decode:true crayon-selected">sudo vim /etc/apache2/httpd.conf</pre>

<p>On dÃ©commente la ligne suivante :</p>

<pre class="lang:apache decode:true">LoadModule php5_module libexec/apache2/libphp5.so</pre>

<p>On redÃ©marre ApacheÂ :</p>

<pre class="lang:sh decode:true">sudo apachectl restart</pre>

<p>On teste le fonctionnement de php avec notre fichier crÃ©Ã© prÃ©cÃ©demmentÂ :</p>

<pre class="lang:default decode:true">mv ~/Sites/site1/index.html ~/Sites/site1/index.php
echo  '&lt;?php phpinfo(); ?&gt;' &gt; ~/Sites/site1/index.php</pre>

<p>Puis on pointe sur lâ€™adresse <span style="color: #000000;"><strong>http://site1.local</strong></span>. Si tout sâ€™est bien passÃ©, le phpinfo() devrait sâ€™afficher.</p>

<p>Note : la configuration de php se situe dans /etc/php.ini.default (Ã  renommer en php.ini).</p>

<pre class="lang:default decode:true">cd /etc
sudo cp php.ini.default php.ini
sudo chmod ug+w php.ini
sudo chgrp staff php.ini</pre>

<h1 id="installer-mysql">Installer MySQL</h1>

<p>Avant dâ€™installer MySQL, rendez vous dans <strong>PrÃ©fÃ©rences systÃ¨mes-&gt;SystÃ¨me et confidentialitÃ©</strong>. AprÃ¨s avoir dÃ©vÃ©rrouillÃ© le cadenas, cochez â€œnâ€™importe oÃ¹â€ pour la section â€œAutoriser les applications tÃ©lÃ©chargÃ©es deâ€.</p>

<p><a href="http://elliptips.info/wp-content/uploads/2012/11/autorisation-app-osx.png"><img class="aligncenter size-full wp-image-1714" title="autorisation-app-osx" alt="autorisation app osx Installer Apache, MySQL et PHP sous OSX sans passer par MAMP" src="http://elliptips.info/wp-content/uploads/2012/11/autorisation-app-osx.png" width="660" height="519" srcset="http://elliptips.info/wp-content/uploads/2012/11/autorisation-app-osx.png 660w, http://elliptips.info/wp-content/uploads/2012/11/autorisation-app-osx-300x235.png 300w" sizes="(max-width: 660px) 100vw, 660px" /></a></p>

<p>Sur le site de MySQL, on tÃ©lÃ©charge la version 64 bits sous format <strong>dâ€™archive DMG</strong> Â (<span style="color: #339966;"><strong>Mac OS X ver. 10.6 (x86, 64-bit), DMG Archive</strong>)</span></p>

<p>Le site :Â <a href="http://dev.mysql.com/downloads/mysql/" title="TÃ©lÃ©chargement de MySQL">http://dev.mysql.com/downloads/mysql/</a></p>

<p>Note : vous nâ€™Ãªtes pas obligÃ© de vous inscrire pour tÃ©lÃ©charger MySQL</p>

<p><a href="http://elliptips.info/wp-content/uploads/2012/11/telechargement-mysql1.png"><img class="aligncenter size-full wp-image-1705" title="telechargement-mysql" alt="telechargement mysql1 Installer Apache, MySQL et PHP sous OSX sans passer par MAMP" src="http://elliptips.info/wp-content/uploads/2012/11/telechargement-mysql1.png" width="660" height="368" srcset="http://elliptips.info/wp-content/uploads/2012/11/telechargement-mysql1.png 660w, http://elliptips.info/wp-content/uploads/2012/11/telechargement-mysql1-300x167.png 300w" sizes="(max-width: 660px) 100vw, 660px" /></a></p>

<p>Une fois lâ€™archive dÃ©compressÃ©e et lancÃ©e, il vous suffit dâ€™installer les 3 composants :</p>

<p><a href="http://elliptips.info/wp-content/uploads/2012/11/mysql-installation1.png"><img class="aligncenter size-full wp-image-1707" title="mysql-installation" alt="mysql installation1 Installer Apache, MySQL et PHP sous OSX sans passer par MAMP" src="http://elliptips.info/wp-content/uploads/2012/11/mysql-installation1.png" width="660" height="346" srcset="http://elliptips.info/wp-content/uploads/2012/11/mysql-installation1.png 660w, http://elliptips.info/wp-content/uploads/2012/11/mysql-installation1-300x157.png 300w" sizes="(max-width: 660px) 100vw, 660px" /></a></p>

<p>Pour dÃ©marrer/arrÃªter MySQL, rendez vous dans vos prÃ©fÃ©rences systÃ¨mes :</p>

<p><a href="http://elliptips.info/wp-content/uploads/2012/11/administrer-mysql.png"><img class="aligncenter size-full wp-image-1760" title="administrer-mysql" alt="administrer mysql Installer Apache, MySQL et PHP sous OSX sans passer par MAMP" src="http://elliptips.info/wp-content/uploads/2012/11/administrer-mysql.png" width="660" height="105" srcset="http://elliptips.info/wp-content/uploads/2012/11/administrer-mysql.png 660w, http://elliptips.info/wp-content/uploads/2012/11/administrer-mysql-300x47.png 300w" sizes="(max-width: 660px) 100vw, 660px" /></a></p>

<p>Pour tester MySQLÂ :</p>

<pre class="lang:sh decode:true">/usr/local/mysql/bin/mysql -v</pre>

<p>Cela devrait vous ouvrir un shell MySQL en affichant le numÃ©ro de version. Pour le quitter, faites <strong>Ctrl + C</strong>.</p>

<p>Pour utiliser le binaire directement, on ajoute celui-ci Ã  notre path (Ã  adapter selon votre configuration). SI vous dÃ©buter et utilisez bash, crÃ©er tout simplement un fichier .bash_profile dans votre home.</p>

<pre class="lang:sh decode:true">vim ~/.bash_profile</pre>

<p>Ajoutez-y la ligne suivante :</p>

<pre class="lang:default decode:true">export PATH="/usr/local/mysql/bin:$PATH"</pre>

<p>On teste sans le chemin absolu :</p>

<pre class="lang:sh decode:true">mysql -v</pre>

<h2 id="un-mot-de-passe-root-pour-mysql">Un mot de passe root pour MySQL</h2>

<p>Il est important de dÃ©finir un mot de passe root pour MySQL Ã  lâ€™aide de la commande suivanteÂ :</p>

<pre class="lang:default decode:true">mysqladmin -u root password 'motdepasse'</pre>

<p>Faites attention Ã  bien utiliser les simples quotes.</p>

<h1 id="installer-phpmyadmin">Installer phpMyAdmin</h1>

<p>Se rendre sur la page de download de phpMyAdmin :</p>

<p><a href="http://www.phpmyadmin.net/home_page/downloads.php" title="TÃ©lÃ©charger phpMyAdmin">http://www.phpmyadmin.net/home_page/downloads.php</a></p>

<p>On rÃ©cupÃ¨re le fichierÂ <span style="color: #339966;"><strong>phpMyAdmin-3.5.3-all-languages.zip</strong></span>.</p>

<p>Une fois dÃ©compressÃ©, on renomme le dossier en phpmyadmin puis on le place Ã  la racine dans ~/Sites.</p>

<p>On fixe un problÃ¨me dâ€™erreur 2002 :</p>

<p><a href="http://elliptips.info/wp-content/uploads/2012/11/erreur-200-phpmyadmin.png"><img class="aligncenter size-full wp-image-1703" title="erreur-2002-phpmyadmin" alt="erreur 200 phpmyadmin Installer Apache, MySQL et PHP sous OSX sans passer par MAMP" src="http://elliptips.info/wp-content/uploads/2012/11/erreur-200-phpmyadmin.png" width="660" height="170" srcset="http://elliptips.info/wp-content/uploads/2012/11/erreur-200-phpmyadmin.png 660w, http://elliptips.info/wp-content/uploads/2012/11/erreur-200-phpmyadmin-300x77.png 300w" sizes="(max-width: 660px) 100vw, 660px" /></a></p>

<pre class="lang:default decode:true">sudo mkdir /var/mysql
sudo ln -s /tmp/mysql.sock /var/mysql/mysql.sock</pre>

<p>On pointe sur lâ€™adresse <span style="color: #000000;"><strong>http://localhost/~votreuser/phpmyadmin/</strong></span></p>

<p>Il suffit alors de se connecter avec lâ€™utilisateur root et le mot de passe que vous avez configurÃ© dans lâ€™Ã©tape prÃ©cÃ©dente.</p>

<p><a href="http://elliptips.info/wp-content/uploads/2012/11/connexion-phpmyadmin.png"><img class="aligncenter size-full wp-image-1704" title="connexion-phpmyadmin" alt="connexion phpmyadmin Installer Apache, MySQL et PHP sous OSX sans passer par MAMP" src="http://elliptips.info/wp-content/uploads/2012/11/connexion-phpmyadmin.png" width="660" height="265" srcset="http://elliptips.info/wp-content/uploads/2012/11/connexion-phpmyadmin.png 660w, http://elliptips.info/wp-content/uploads/2012/11/connexion-phpmyadmin-300x120.png 300w" sizes="(max-width: 660px) 100vw, 660px" /></a></p>

<h1 id="en-bonus--un-script-pour-gnrer-vos-vhosts">En bonus : un script pour gÃ©nÃ©rer vos vhosts</h1>

<p>Dans le but de simplifier un peu plus la procÃ©dure dâ€™ajout de vhosts, jâ€™ai crÃ©Ã© un petit <strong>script bash</strong> dÃ©diÃ© Ã  cette tÃ¢che qui :</p>

<ul>
  <li>Ã©ditera le fichier /etc/hosts</li>
  <li>crÃ©era un repertoire dÃ©diÃ© au site dans ~/Sites (sâ€™il nâ€™existe pas dÃ©jÃ )</li>
  <li>Ã©ditera un vhost dans votre httpd-vhosts.conf</li>
  <li>redÃ©marrera Apache pour prendre en compte les changements</li>
</ul>

<p><a href="http://elliptips.info/wp-content/uploads/2012/11/vhosts-generator.png"><img class="aligncenter size-full wp-image-1717" title="vhosts-generator" alt="vhosts generator Installer Apache, MySQL et PHP sous OSX sans passer par MAMP" src="http://elliptips.info/wp-content/uploads/2012/11/vhosts-generator.png" width="652" height="408" srcset="http://elliptips.info/wp-content/uploads/2012/11/vhosts-generator.png 652w, http://elliptips.info/wp-content/uploads/2012/11/vhosts-generator-300x187.png 300w" sizes="(max-width: 652px) 100vw, 652px" /></a></p>

<p>##</p>

<h2 id="pour-l8217utiliser">Pour lâ€™utiliser</h2>

<p>RÃ©cupÃ©rez Â le script sur <a href="https://github.com/robinparisi/scripts-osx/blob/master/vhosts-generator.sh" title="vhosts generator sur Github">Github</a> :</p>

<pre class="lang:sh decode:true">curl -OL https://raw.github.com/robinparisi/scripts-osx/master/vhosts-generator.sh</pre>

<p>Rendez-le exÃ©cutable :</p>

<pre class="lang:default decode:true">chmod +x vhosts-generator.sh</pre>

<p>Editez la partie concernant le user :</p>

<pre class="lang:default decode:true">USER="votre_user_ici"</pre>

<p>Lancez-le (sans oublier sudo nÃ©cessaire car demande lâ€™Ã©dition du fichier hosts et le contrÃ´le dâ€™Apache) :</p>

<pre class="lang:default decode:true">sudo ./vhosts-generator.sh</pre>

<p>Choisir un nom de domaine (celui que vous entrerez dans votre navigateur pour accÃ©der au site en local) et un nom pour le rÃ©pertoire du site.</p>

<p>Et voilÃ , vous avez maintenant un environnement de dÃ©veloppement fonctionnel et pleinement intÃ©grÃ© Ã  votre systÃ¨me. Si vous testez ce tutoriel depuis une autre version de Mac OS X, nâ€™hÃ©sitez pas Ã  valider la procÃ©dure dans les commentaires.</p>

<p>Bon dev Ã  tous ğŸ™‚</p>

        </div>
    </div>

    
</article>

      </div>
    </main>

    <div class="container">
    <footer class="footer txtcenter">
        Sauf mention spÃ©ciale, le contenu de ce site est distribuÃ© sous licence <a href="#">CC BY-NC-SA 3.0</a>
    </footer>
</div>


  </body>

</html>
